# PDF 书签分割工具

一个基于 PDF 书签结构进行文件分割的 Python 工具。该工具能够根据 PDF 的书签将文档分割成多个文件，并且支持控制分割的层级深度。  

- [English](https://github.com/JoeChen2me/pdf-bookmark-splitter/blob/main/README.md)
- 简体中文

## 功能特点

- 根据书签结构分割 PDF 文件
- 可控制分割深度（例如，仅在章节级别分割，或包含子章节）
- 可自定义输出目录
- 保持 PDF 内容和格式不变
- 支持嵌套书签结构
- 自动将书签标题转换为合适的文件名

## 系统要求

- Python 3.6 或更高版本
- PyPDF2 库

## 安装方法

1. 确保您的系统已安装 Python
2. 安装所需的 PyPDF2 库：
```bash
pip install PyPDF2
```

## 使用方法

基本命令格式：
```bash
python split_pdf_by_bookmarks.py 输入PDF文件 [-o 输出目录] [-d 深度]
```

### 参数说明

- `输入PDF文件`（必需）：待分割的 PDF 文件路径
- `-o, --output-dir`：分割后的 PDF 文件保存目录（默认："split_pdfs"）
- `-d, --depth`：分割的最大层级深度（默认：None，使用所有层级）

### 使用示例

1. 使用所有书签层级进行分割（默认行为）：
```bash
python split_pdf_by_bookmarks.py "文档.pdf"
```

2. 仅在第 2 层级进行分割（章节和小节，不包含子小节）：
```bash
python split_pdf_by_bookmarks.py "文档.pdf" -d 2
```

3. 指定自定义输出目录：
```bash
python split_pdf_by_bookmarks.py "文档.pdf" -o "输出文件夹"
```

4. 同时指定分割深度和自定义输出目录：
```bash
python split_pdf_by_bookmarks.py "文档.pdf" -d 2 -o "仅章节"
```

## 深度层级说明

深度层级对应 PDF 中的书签层次结构：

- 第 1 级：主章节（如："1. 引言"）
- 第 2 级：节（如："1.1 背景"）
- 第 3 级：小节（如："1.1.1 历史"）

不同深度值对分割的影响示例：

```
原始结构：
1. 第一章
   1.1 第一节
       1.1.1 子节 A
       1.1.2 子节 B
   1.2 第二节
2. 第二章
   2.1 第一节

使用 -d 1 时：
- "第一章.pdf"（包含 1.1 和 1.2 的所有内容）
- "第二章.pdf"（包含 2.1 的所有内容）

使用 -d 2 时：
- "第一章.pdf"
- "第一节.pdf"（包含 1.1.1 和 1.1.2）
- "第二节.pdf"
- "第二章.pdf"
- "第一节.pdf"

不指定深度时：
- "第一章.pdf"
- "第一节.pdf"
- "子节 A.pdf"
- "子节 B.pdf"
- "第二节.pdf"
- "第二章.pdf"
- "第一节.pdf"
```

## 输出说明

- 脚本会创建一个目录（默认为 "split_pdfs" 或通过 -o 指定）
- 每个书签都会生成一个独立的 PDF 文件
- 文件名由书签标题生成，特殊字符会被替换为下划线
- 脚本会保持原始 PDF 的页面顺序和内容

## 错误处理

- 如果输入文件不存在，脚本会显示错误信息
- 如果 PDF 中没有找到书签，脚本会通知用户
- 无效的深度值会被妥善处理

## 使用限制

- 脚本要求 PDF 具有正确的书签结构
- 过长的书签标题在文件名中会被截断为 150 个字符
- 书签标题中的特殊字符在文件名中会被替换为下划线

## 使用技巧

1. 在分割之前，建议先备份原始 PDF 文件
2. 使用 --help 选项查看所有可用参数：
```bash
python split_pdf_by_bookmarks.py --help
```
3. 建议先不指定深度限制来查看完整结构，然后使用 -d 参数来获得所需的分割粒度
4. 分割后检查输出目录，确保所有文件都按预期创建

## 故障排除

如果遇到问题：

1. 确保您的 PDF 包含书签（目录）
2. 检查输出目录的写入权限
3. 验证输入 PDF 路径是否正确
4. 确保有足够的磁盘空间存储分割后的文件

## 实际应用举例

比如对于一个技术文档：
```bash
# 将整本技术手册按章节分割
python split_pdf_by_bookmarks.py "技术手册.pdf" -d 1 -o "章节版本"

# 将教程按详细小节分割
python split_pdf_by_bookmarks.py "教程.pdf" -o "完整小节"

# 将参考手册按二级目录分割
python split_pdf_by_bookmarks.py "参考手册.pdf" -d 2 -o "参考手册分章节"